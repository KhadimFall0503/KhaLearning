{% extends 'main/base.html' %} {% load static %} {% block content %}

<!-- ================= HERO ================= -->
<section class="bg-gray-900 text-white py-28">
  <div class="max-w-7xl mx-auto px-6 text-center">
    <h1 class="text-5xl font-extrabold mb-6">Toutes nos formations</h1>
    <p class="text-gray-300 text-lg">
      Parcourez nos formations pour développer vos compétences dans divers
      domaines
    </p>
  </div>
</section>

<!-- ================= CATEGORIES ================= -->
<section class="max-w-7xl mx-auto px-6 py-8">
  <div class="flex flex-wrap justify-center gap-4">
    <a
      href="{% url 'formations' %}"
      class="px-4 py-2 rounded border hover:bg-orange-500 hover:text-white {% if not selected_category %}bg-orange-500 text-white{% endif %}"
    >
      Toutes
    </a>
    {% for category in categories %}
    <a
      href="?category={{ category.id }}"
      class="px-4 py-2 rounded border hover:bg-orange-500 hover:text-white {% if selected_category and selected_category.id == category.id %}bg-orange-500 text-white{% endif %}"
    >
      {{ category.name }}
    </a>
    {% endfor %}
  </div>
</section>

<!-- ================= SEARCH ================= -->
<section class="max-w-7xl mx-auto px-6 py-4">
  <form method="get" class="flex justify-center">
    {% if selected_category %}
    <input type="hidden" name="category" value="{{ selected_category.id }}" />
    {% endif %}
    <input
      type="text"
      name="q"
      placeholder="Rechercher une formation..."
      value="{{ request.GET.q }}"
      class="border rounded-l px-4 py-2 w-2/3 focus:outline-none focus:ring-2 focus:ring-orange-500"
    />
    <button
      type="submit"
      class="bg-orange-500 text-white px-4 py-2 rounded-r hover:bg-orange-600 transition"
    >
      Rechercher
    </button>
  </form>
</section>

<!-- ================= TOUS LES COURS ================= -->
<section class="py-12 bg-gray-50">
  <div class="max-w-7xl mx-auto px-6">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for course in courses %}
      <div
        class="relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1 overflow-hidden"
      >
        {% if course.youtube_url %}
        <span
          class="absolute top-3 left-3 bg-red-600 text-white text-xs font-bold px-2 py-1 rounded-full z-10"
        >
          YouTube
        </span>
        {% endif %}
        <a href="{% url 'course_detail' course.id %}">
          <img
            src="{% if course.youtube_thumbnail %}{{ course.youtube_thumbnail }}{% elif course.image %}{{ course.image.url }}{% else %}{% static 'main/images/default-course.jpg' %}{% endif %}"
            class="w-full h-64 object-cover rounded-t-2xl transition-transform duration-300 hover:scale-105"
            alt="{{ course.title }} thumbnail"
          />
        </a>
        <div class="p-6">
          <h3 class="text-2xl font-bold mb-2 line-clamp-2">
            {{ course.title }}
          </h3>
          <p class="text-gray-700 mb-4 line-clamp-3">
            {{ course.description|truncatewords:25 }}
          </p>
          <p class="text-sm text-gray-500 mb-4">
            Catégorie: {{ course.category.name }}
          </p>
          <a
            href="{% url 'course_detail' course.id %}"
            class="inline-block px-5 py-2 bg-gradient-to-r from-orange-400 to-orange-600 text-white rounded-full hover:scale-105 transition transform font-semibold shadow-lg"
          >
            Voir le cours
          </a>
        </div>
      </div>
      {% empty %}
      <p class="col-span-full text-center text-gray-500">
        Aucune formation disponible pour le moment.
      </p>
      {% endfor %}
    </div>
  </div>
</section>

{% endblock %}
